<!DOCTYPE html>
<html>
<head>
	<title></title>
	<meta charset="utf-8">
	<link rel="stylesheet" type="text/css" href="./h-form.css">
  <style type="text/css">
    .tmp {
      width: 70%;
      max-width: 700px;
      margin: 50px auto;
      margin-bottom: 100px;
    }
    [class*=col-] {
      float: left;
      box-sizing: border-box;
    }
    .col-11 {
      width: 45.83333%;
    }
    .col-2 {
      width: 8.33333%;
    }
  </style>

  <!-- 一个下拉框插件，演示用 -->
  <link rel="stylesheet" type="text/css" href="./lib/hselector/hselector.css">
  <script src="./lib/hselector/hselector.js"></script>
</head>
<body>
	<div class="tmp">

      <form class="h-form" id="test">
        <div class="h-form-item" prop="email">
          <label class="h-form-item--label">邮箱</label>
          <div class="h-form-item--content">
            <div class="h-input">
              <input class="h-input--inner" type="text">
            </div>
          </div>
        </div>
        
        <div class="h-form-item" prop="phone">
          <label class="h-form-item--label">手机</label>
          <div class="h-form-item--content">
            <input class="h-input--inner" type="text">
          </div>
        </div>

        <div class="h-form-item" prop="range">
          <label class="h-form-item--label">范围</label>
          <div class="h-form-item--content">
            <div class="col-11">
              <input class="h-input--inner" type="text">
            </div>
            <div class="col-2" style="text-align: center;">-</div>
            <div class="col-11">
              <input class="h-input--inner" type="text">
            </div>
          </div>
        </div>

        <div class="h-form-item" prop="name">
          <label class="h-form-item--label">用户名</label>
          <div class="h-form-item--content">
            <input class="h-input--inner" type="text">
          </div>
        </div>

        <div class="h-form-item">
          <label class="h-form-item--label">活动时间</label>
          <div class="h-form-item--content">
            <div class="col-11">
              <div class="h-form-item" prop="activeDate">
                <div class="h-form-item--content" style="margin: 0">
                  <input class="h-input--inner" placeholder="内嵌的 form-item">
                </div>
              </div>
            </div>
            <div class="col-2" style="text-align: center;">-</div>
            <div class="col-11">
              <div class="h-form-item" prop="activeTime">
                <div class="h-form-item--content" style="margin: 0">
                  <input class="h-input--inner" placeholder="内嵌的 form-item">
                </div>
              </div>
            </div>
          </div>
        </div>

        <div class="h-form-item" prop="pass">
          <label class="h-form-item--label">密码</label>
          <div class="h-form-item--content">
            <input class="h-input--inner" type="text">
          </div>
        </div>

        <div class="h-form-item" prop="repass">
          <label class="h-form-item--label">确认密码</label>
          <div class="h-form-item--content">
            <div class="h-input">
              <input class="h-input--inner" type="text">
            </div>
          </div>
        </div>

        <div class="h-form-item" prop="cardtype">
          <label class="h-form-item--label">证件类型</label>
          <div class="h-form-item--content">
            <input class="h-input--inner" id="m-selector2" readonly="readonly" type="text">
          </div>
        </div>

        <div class="h-form-item" prop="identity">
          <label class="h-form-item--label">证件号码</label>
          <div class="h-form-item--content">
            <input class="h-input--inner" type="text" placeholder="请输入 'sfz' 或 'passport' 或 'hk' 用于测试">
          </div>
        </div>

        <div class="h-form-item" prop="study">
          <label class="h-form-item--label">学习</label>
          <div class="h-form-item--content">
            <label class="h-switch">
              <input class="h-switch--input" type="checkbox">
              <span class="h-switch--inner"></span>
            </label>
          </div>
        </div>

        <div class="h-form-item" prop="hobby">
          <label class="h-form-item--label">喜好</label>
          <div class="h-form-item--content">
            <div class="h-checkbox-group">
              <label class="h-checkbox">
                <input type="checkbox" value="male" class="h-checkbox--input">
                <span class="h-checkbox--inner"></span>
                <span class="h-checkbox--label">男</span>
              </label>
              <label class="h-checkbox">
                <input type="checkbox" value="female" class="h-checkbox--input">
                <span class="h-checkbox--inner"></span>
                <span class="h-checkbox--label">女</span>
              </label>
              <label class="h-checkbox">
                <input type="checkbox" value="bitch" class="h-checkbox--input">
                <span class="h-checkbox--inner"></span>
                <span class="h-checkbox--label">妖</span>
              </label>
            </div>
          </div>
        </div>

        <div class="h-form-item" prop="sex">
          <label class="h-form-item--label">性别</label>
          <div class="h-form-item--content">
            <div class="h-checkbox-group">
              <label class="h-checkbox">
                <input type="radio" name="sex" value="male" class="h-radio--input">
                <span class="h-radio--inner"></span>
                <span class="h-radio--label">男</span>
              </label>
              <label class="h-checkbox">
                <input type="radio" name="sex" value="female" class="h-radio--input">
                <span class="h-radio--inner"></span>
                <span class="h-radio--label">女</span>
              </label>
            </div>
          </div>
        </div>

        <div class="h-form-item" prop="comment">
          <label class="h-form-item--label">评论</label>
          <div class="h-form-item--content">
            <div class="h-textarea">
              <textarea class="h-textarea--inner"></textarea>
            </div>
          </div>
        </div>

        <div class="h-form-item">
          <div class="h-form-item--content">
            <button type="button" class="h-button h-button-primary" id="submit">提交</button>
            <button type="button" class="h-button" id="reset">重置</button>
            <button type="button" class="h-button" id="setvalue">赋值</button>
          </div>
        </div>
      </form>


      <hr style="margin: 30px 0" />

      <h2>去掉样式的表单元素</h2>

      <form class="h-form" id="test2">
        <div class="h-form-item" prop="name">
          <label class="h-form-item--label">名称</label>
          <div class="h-form-item--content">
            <input type="text">
          </div>
        </div>

        <div class="h-form-item" prop="price">
          <label class="h-form-item--label">价格</label>
          <div class="h-form-item--content">
            <input type="text">
          </div>
        </div>

        <div class="h-form-item" prop="noodle">
          <label class="h-form-item--label">面条</label>
          <div class="h-form-item--content">
            <label>软</label><input type="radio" name="noodle" value="soft">
            <label>适中</label><input type="radio" name="noodle" value="middle">
            <label>硬</label><input type="radio" name="noodle" value="hard">
          </div>
        </div>

        <div class="h-form-item" prop="soup">
          <label class="h-form-item--label">汤底</label>
          <div class="h-form-item--content">
            <select>
              <option>豚骨</option>
              <option>鸡骨</option>
              <option>酱油</option>
            </select>
          </div>
        </div>

        <div class="h-form-item" prop="side">
          <label class="h-form-item--label">配菜</label>
          <div class="h-form-item--content">
            <label>溏心蛋</label><input type="checkbox" value="egg">
            <label>海苔</label><input type="checkbox" value="ht">
            <label>葱</label><input type="checkbox" value="c">
            <label>叉烧</label><input type="checkbox" value="cs">
          </div>
        </div>

        <div class="h-form-item" prop="taste">
          <label class="h-form-item--label">调料</label>
          <div class="h-form-item--content">
            <select multiple="multiple">
              <option>加辣</option>
              <option>加油</option>
              <option>胡椒</option>
            </select>
          </div>
        </div>

        <div class="h-form-item" prop="remark">
          <label class="h-form-item--label">备注</label>
          <div class="h-form-item--content">
            <textarea></textarea>
          </div>
        </div>

        <div class="h-form-item">
          <div class="h-form-item--content">
            <button type="button" id="submit2">提交</button>
            <button type="button" id="reset2">重置</button>
            <button type="button" id="setvalue2">赋值</button>
          </div>
        </div>
      </form>

    </div>

<script src="./h-form.js"></script>
<script type="text/javascript">

  /*----------初始化表单------------*/
  //自定义验证函数
  var checkpass = function(value) {
    //this 为对应的 ValidForm 实例, this[prop] 能获得最新的 prop 数据
    if(value === this.pass) return true;
    return false;
  }
  var checkIdentity = function(value) {
    if(this.cardtype === '身份证') {
      if(value === 'sfz') return true;
    }else if(this.cardtype === '护照') {
      if(value === 'passport') return true;
    }else if(this.cardtype === '港澳居民证') {
      if(value === 'hk') return true;
    }
    return false;
  }
  var checkNumber = function(value) {
    var reg = /^[0-9]*$/;
    var valid = true;
    for(var i=0; i<value.length; i++) {
      valid = valid && reg.test(value[i]);
    }
    return valid;
  }

  //表单验证规则
  var rules = {
    email: [
      { required: true, message: '请输入邮箱' },
      { email: true, message: '请输入正确的邮箱', trigger: 'input' },
    ],
    phone: [
      { required: true, message: '请输入手机号' },
      { phone: true, message: '请输入正确的手机号码' },
    ],
    pass: [
      { required: true, message: '请输入密码'}
    ],
    repass: [
      { validator: checkpass, message: '两次密码不一致' }
    ],
    identity: [
      { required: true, message: '请输入证件号码' },
      { validator: checkIdentity, message: '请输入正确的证件号码' }
    ],
    hobby: [
      { required: true, message: '请选择喜好'}
    ],
    sex: [
      { required: true, message: '请选择性别'}
    ],
    activeDate: [
      { required: true, message: '请选择活动日期'}
    ],
    activeTime: [
      { required: true, message: '请选择活动时间'}
    ],
    range: [
      { required: true, message: '请选择范围'},
      /*range 为多个 input 的结构，因此值为数组，所以需要自定义验证函数*/
      { validator: checkNumber, message: '范围值必须为数字'}
    ]
  }

  var mForm = validForm.init('test', rules);

  /* 第三个参数可以初始化赋值
  var data = {
    email: '123@qq.com'
  }
  var mForm = validForm.init('test', rules, data);
  */

  /*----------初始化下拉框------------*/
  var data3 = [
    { label: '身份证', value:'identity' },
    { label: '护照', value:'passport' },
    { label: '港澳居民证', value:'hk' }
  ];
  hselector.init({
      id: 'm-selector2',
      data: data3,
      label: 'label',
      value: 'value',
      currentValue: data3[0],
      clickCallback: function(value) {
          console.log('clickCallback----', value)
      }
  })


  /*----------表单提交、重置、赋值事件------------*/
  var submit = document.getElementById('submit');
  var reset = document.getElementById('reset');
  var setvalue = document.getElementById('setvalue');

  submit.onclick = function() {
    mForm.validate(function(valid, data) {
      if(valid) {
        alert('submit success!');
        console.log(data);
      }else {
        console.log('submit error');
      }
    })
  }

  reset.onclick = function() {
    mForm.reset();
  }

  setvalue.onclick = function() {
    var data = {
      cardtype: '身份证',
      identity: 'sfz',
      email: 'hehe@qq.cn',
      phone: '13112341234',
      name : 'test',
      pass : '123',
      repass: '123',
      activeDate: '2018-08-30',
      activeTime: '17:30',
      sex : 'female',
      hobby : ['bitch', 'female'],
      range : ['1', '10'],
      study: true,
      comment: '这系统真烂！'
    }
    mForm.setValue(data);
  }




  /*----------初始化表单2------------*/
    var rules2 = {
      name: [
        { required: true, message: '请输入名称' }
      ],
      price: [
        { required: true, message: '请输入价格' },
        { number: true, message: '请输入数字', trigger: 'input' },
      ],
      noodle: [
        { required: true, message: '请选择面的硬度' },
      ],
      soup: [
        { required: true, message: '请选择汤底' },
      ],
      side: [
        { required: true, message: '请选择配菜' },
      ],
      taste: [
        { required: true, message: '请选择配料' },
      ]
    }

  var mForm2 = validForm.init('test2', rules2);

  var submit2 = document.getElementById('submit2');
  var reset2 = document.getElementById('reset2');
  var setvalue2 = document.getElementById('setvalue2');

  submit2.onclick = function() {
    mForm2.validate(function(valid, data) {
      if(valid) {
        alert('submit success!');
        console.log(data);
      }else {
        console.log('submit error');
      }
    })
  }

  reset2.onclick = function() {
    mForm2.reset();
  }

  setvalue2.onclick = function() {
    var data = {
      name: '经典豚骨拉面',
      price: '55',
      noodle: 'middle',
      soup: '豚骨',
      side: ['cs','egg'],
      taste: ['加辣','胡椒'],
      remark: '少放点肉'
    }
    mForm2.setValue(data);
  }



</script>
</body>
</html>